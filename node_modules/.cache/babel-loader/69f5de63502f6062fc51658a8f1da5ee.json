{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ClassSerializerInterceptor = void 0;\n\nconst tslib_1 = require(\"tslib\");\n\nconst operators_1 = require(\"rxjs/operators\");\n\nconst core_1 = require(\"../decorators/core\");\n\nconst file_stream_1 = require(\"../file-stream\");\n\nconst load_package_util_1 = require(\"../utils/load-package.util\");\n\nconst shared_utils_1 = require(\"../utils/shared.utils\");\n\nconst class_serializer_constants_1 = require(\"./class-serializer.constants\");\n\nlet classTransformer = {}; // NOTE (external)\n// We need to deduplicate them here due to the circular dependency\n// between core and common packages\n\nconst REFLECTOR = 'Reflector';\nlet ClassSerializerInterceptor = class ClassSerializerInterceptor {\n  constructor(reflector) {\n    let defaultOptions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var _a;\n\n    this.reflector = reflector;\n    this.defaultOptions = defaultOptions;\n    classTransformer = (_a = defaultOptions === null || defaultOptions === void 0 ? void 0 : defaultOptions.transformerPackage) !== null && _a !== void 0 ? _a : (0, load_package_util_1.loadPackage)('class-transformer', 'ClassSerializerInterceptor', () => require('class-transformer'));\n\n    if (!(defaultOptions === null || defaultOptions === void 0 ? void 0 : defaultOptions.transformerPackage)) {\n      require('class-transformer');\n    }\n  }\n\n  intercept(context, next) {\n    const contextOptions = this.getContextOptions(context);\n    const options = Object.assign(Object.assign({}, this.defaultOptions), contextOptions);\n    return next.handle().pipe((0, operators_1.map)(res => this.serialize(res, options)));\n  }\n  /**\n   * Serializes responses that are non-null objects nor streamable files.\n   */\n\n\n  serialize(response, options) {\n    if (!(0, shared_utils_1.isObject)(response) || response instanceof file_stream_1.StreamableFile) {\n      return response;\n    }\n\n    return Array.isArray(response) ? response.map(item => this.transformToPlain(item, options)) : this.transformToPlain(response, options);\n  }\n\n  transformToPlain(plainOrClass, options) {\n    if (!plainOrClass) {\n      return plainOrClass;\n    }\n\n    if (!options.type) {\n      return classTransformer.classToPlain(plainOrClass, options);\n    }\n\n    if (plainOrClass instanceof options.type) {\n      return classTransformer.classToPlain(plainOrClass, options);\n    }\n\n    const instance = classTransformer.plainToClass(options.type, plainOrClass);\n    return classTransformer.classToPlain(instance, options);\n  }\n\n  getContextOptions(context) {\n    return this.reflector.getAllAndOverride(class_serializer_constants_1.CLASS_SERIALIZER_OPTIONS, [context.getHandler(), context.getClass()]);\n  }\n\n};\nClassSerializerInterceptor = tslib_1.__decorate([(0, core_1.Injectable)(), tslib_1.__param(0, (0, core_1.Inject)(REFLECTOR)), tslib_1.__param(1, (0, core_1.Optional)()), tslib_1.__metadata(\"design:paramtypes\", [Object, Object])], ClassSerializerInterceptor);\nexports.ClassSerializerInterceptor = ClassSerializerInterceptor;","map":{"version":3,"names":["Object","defineProperty","exports","value","ClassSerializerInterceptor","tslib_1","require","operators_1","core_1","file_stream_1","load_package_util_1","shared_utils_1","class_serializer_constants_1","classTransformer","REFLECTOR","constructor","reflector","defaultOptions","_a","transformerPackage","loadPackage","intercept","context","next","contextOptions","getContextOptions","options","assign","handle","pipe","map","res","serialize","response","isObject","StreamableFile","Array","isArray","item","transformToPlain","plainOrClass","type","classToPlain","instance","plainToClass","getAllAndOverride","CLASS_SERIALIZER_OPTIONS","getHandler","getClass","__decorate","Injectable","__param","Inject","Optional","__metadata"],"sources":["C:/Users/Admin/Desktop/NikeShoes/node_modules/@nestjs/common/serializer/class-serializer.interceptor.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ClassSerializerInterceptor = void 0;\nconst tslib_1 = require(\"tslib\");\nconst operators_1 = require(\"rxjs/operators\");\nconst core_1 = require(\"../decorators/core\");\nconst file_stream_1 = require(\"../file-stream\");\nconst load_package_util_1 = require(\"../utils/load-package.util\");\nconst shared_utils_1 = require(\"../utils/shared.utils\");\nconst class_serializer_constants_1 = require(\"./class-serializer.constants\");\nlet classTransformer = {};\n// NOTE (external)\n// We need to deduplicate them here due to the circular dependency\n// between core and common packages\nconst REFLECTOR = 'Reflector';\nlet ClassSerializerInterceptor = class ClassSerializerInterceptor {\n    constructor(reflector, defaultOptions = {}) {\n        var _a;\n        this.reflector = reflector;\n        this.defaultOptions = defaultOptions;\n        classTransformer =\n            (_a = defaultOptions === null || defaultOptions === void 0 ? void 0 : defaultOptions.transformerPackage) !== null && _a !== void 0 ? _a : (0, load_package_util_1.loadPackage)('class-transformer', 'ClassSerializerInterceptor', () => require('class-transformer'));\n        if (!(defaultOptions === null || defaultOptions === void 0 ? void 0 : defaultOptions.transformerPackage)) {\n            require('class-transformer');\n        }\n    }\n    intercept(context, next) {\n        const contextOptions = this.getContextOptions(context);\n        const options = Object.assign(Object.assign({}, this.defaultOptions), contextOptions);\n        return next\n            .handle()\n            .pipe((0, operators_1.map)((res) => this.serialize(res, options)));\n    }\n    /**\n     * Serializes responses that are non-null objects nor streamable files.\n     */\n    serialize(response, options) {\n        if (!(0, shared_utils_1.isObject)(response) || response instanceof file_stream_1.StreamableFile) {\n            return response;\n        }\n        return Array.isArray(response)\n            ? response.map(item => this.transformToPlain(item, options))\n            : this.transformToPlain(response, options);\n    }\n    transformToPlain(plainOrClass, options) {\n        if (!plainOrClass) {\n            return plainOrClass;\n        }\n        if (!options.type) {\n            return classTransformer.classToPlain(plainOrClass, options);\n        }\n        if (plainOrClass instanceof options.type) {\n            return classTransformer.classToPlain(plainOrClass, options);\n        }\n        const instance = classTransformer.plainToClass(options.type, plainOrClass);\n        return classTransformer.classToPlain(instance, options);\n    }\n    getContextOptions(context) {\n        return this.reflector.getAllAndOverride(class_serializer_constants_1.CLASS_SERIALIZER_OPTIONS, [\n            context.getHandler(),\n            context.getClass(),\n        ]);\n    }\n};\nClassSerializerInterceptor = tslib_1.__decorate([\n    (0, core_1.Injectable)(),\n    tslib_1.__param(0, (0, core_1.Inject)(REFLECTOR)),\n    tslib_1.__param(1, (0, core_1.Optional)()),\n    tslib_1.__metadata(\"design:paramtypes\", [Object, Object])\n], ClassSerializerInterceptor);\nexports.ClassSerializerInterceptor = ClassSerializerInterceptor;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}